(()=>{function c(){let e=new Date,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),a=new Date(n.getTime()-24*60*60*1e3),o=new Date(n.getTime()-1e3*60),s=Math.floor(a.getTime()/1e3),t=Math.floor(o.getTime()/1e3);return{s,e:t}}async function i(){var e;try{let{s:n,e:a}=c(),o=`https://affiliate.shopee.vn/api/v3/report/list?page_size=500&page_num=1&purchase_time_s=${n}&purchase_time_e=${a}&version=1`,s=await fetch(o,{method:"GET",credentials:"include"});if(s.status===401){chrome.runtime.sendMessage({type:"POLL_RESULT",ok:!1,reason:"UNAUTHORIZED"});return}if(!s.ok){chrome.runtime.sendMessage({type:"POLL_RESULT",ok:!1,reason:`HTTP_${s.status}`});return}let t=await s.json().catch(()=>null);if(!t||t.code!==0){chrome.runtime.sendMessage({type:"POLL_RESULT",ok:!1,reason:"BAD_RESPONSE"});return}let r=((e=t==null?void 0:t.data)==null?void 0:e.total_count)??0;chrome.runtime.sendMessage({type:"POLL_RESULT",ok:!0,totalCount:Number(r)||0})}catch{chrome.runtime.sendMessage({type:"POLL_RESULT",ok:!1,reason:"NETWORK_ERROR"})}}chrome.runtime.onMessage.addListener(e=>{(e==null?void 0:e.type)==="POLL_NOW"&&i()});})();
