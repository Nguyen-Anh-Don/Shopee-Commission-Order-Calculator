<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>T·ªïng quan Video - Shopee Commission Calculator</title>
        <link href="/css/bootstrap.min.css" rel="stylesheet" />
        <link href="/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
        <style>
            body {
                background-color: #fffaf5;
                color: #333;
                font-family: "Segoe UI", sans-serif;
            }

            a {
                text-decoration: none;
            }

            .filter-section {
                background-color: white;
                border-radius: 8px;
                padding: 8px;
                margin-bottom: 12px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            }

            .stats-card {
                background-color: white;
                border-radius: 8px;
                padding: 8px;
                margin-bottom: 12px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            }

            .summary-stats-card {
                background-color: white;
                border-radius: 8px;
                padding: 15px;
                margin-bottom: 12px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            }

            .summary-box {
                background-color: white;
                border-radius: 8px;
                padding: 12px;
                text-align: center;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
                border: 2px solid #e0e0e0;
                margin-bottom: 10px;
                transition: transform 0.2s;
            }

            .summary-box:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }

            .summary-box.total-videos {
                border-color: #2196f3;
                background-color: #e3f2fd;
                color: #0d47a1;
            }

            .summary-box.total-orders {
                border-color: #4caf50;
                background-color: #e8f5e9;
                color: #1b5e20;
            }

            .summary-box.total-gmv {
                border-color: #ff9800;
                background-color: #fff3e0;
                color: #e65100;
            }

            .summary-box.total-commission {
                border-color: #f36f21;
                background-color: #ffe1b2;
                color: #333;
            }

            .summary-box small {
                display: block;
                font-size: 0.85rem;
                margin-bottom: 5px;
                font-weight: 500;
            }

            .summary-box .summary-value {
                font-size: 1.5rem;
                font-weight: bold;
                margin: 0;
            }

            .table-responsive {
                max-height: 80vh;
                overflow-y: auto;
            }

            .loading {
                text-align: center;
                padding: 20px;
            }

            .video-image {
                width: 60px;
                height: 60px;
                object-fit: cover;
                border-radius: 4px;
            }

            .video-image-placeholder {
                width: 60px;
                height: 60px;
                background-color: #f0f0f0;
                border-radius: 4px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 12px;
                color: #999;
            }

            .has-orders {
                background-color: #e8f5e9;
            }

            .no-orders {
                background-color: #fff3e0;
            }

            .chart-container {
                position: relative;
                height: 300px;
                width: 100%;
            }

            .video-badge {
                display: inline-block;
                padding: 2px 8px;
                border-radius: 12px;
                font-size: 11px;
                font-weight: bold;
            }

            .badge-has-orders {
                background-color: #4caf50;
                color: white;
            }

            .badge-no-orders {
                background-color: #ff9800;
                color: white;
            }

            .quick-date-btn.active {
                background-color: #0d6efd;
                color: white;
                border-color: #0d6efd;
            }

            .quick-date-btn.active:hover {
                background-color: #0b5ed7;
                border-color: #0a58ca;
            }

            .guide-section {
                background-color: white;
                border-radius: 8px;
                padding: 0.5rem;
                margin-top: 1rem;
                margin-bottom: 0.5rem;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            }

            .guide-section h5 {
                color: #0d6efd;
                border-bottom: 2px solid #0d6efd;
                padding-bottom: 0.5rem;
                margin-bottom: 0.5rem;
            }

            .guide-section h6 {
                color: #333;
                margin-top: 0.5rem;
                margin-bottom: 0.5rem;
                font-weight: 600;
            }

            .guide-section ul {
                padding-left: 1rem;
            }

            .guide-section li {
                margin-bottom: 0.5rem;
                line-height: 1.6;
            }

            .guide-section .feature-item {
                background-color: #f8f9fa;
                padding: 0.5rem;
                border-radius: 6px;
                margin-bottom: 0.5rem;
                border-left: 4px solid #0d6efd;
            }

            .guide-section .feature-item strong {
                color: #0d6efd;
            }
        </style>
    </head>
    <body>
        <div class="container mt-4">
            <h4 class="text-center mb-2">üìπ T·ªïng quan Video</h4>
            <div id="common-header"></div>

            <div id="loadingMessage" class="loading">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">ƒêang t·∫£i...</span>
                </div>
                <p class="mt-2">ƒêang t·∫£i d·ªØ li·ªáu...</p>
            </div>

            <div id="noDataMessage" class="alert alert-warning" style="display: none">
                <strong>Ch∆∞a c√≥ d·ªØ li·ªáu video!</strong>
                <p class="mb-1">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o t·ª´ k√™nh video Shopee.</p>
                <p class="mb-0 small">D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã sau khi c√≥ ƒë∆°n h√†ng t·ª´ video.</p>
            </div>

            <div id="noFilterResultsMessage" class="alert alert-info p-2" style="display: none">
                <strong>Kh√¥ng c√≥ k·∫øt qu·∫£!</strong>
                <p class="mb-0">Kh√¥ng t√¨m th·∫•y video n√†o ph√π h·ª£p v·ªõi b·ªô l·ªçc b·∫°n ƒë√£ ch·ªçn. Vui l√≤ng th·ª≠ l·∫°i v·ªõi ti√™u ch√≠ kh√°c.</p>
            </div>

            <div id="mainContent" style="display: none">
                <!-- Ph·∫ßn b·ªô l·ªçc -->
                <div class="filter-section">
                    <form id="filterForm">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="searchInput" class="small">T√¨m ki·∫øm:</label>
                                    <input type="text" class="form-control form-control-sm" id="searchInput" placeholder="ID s·∫£n ph·∫©m ho·∫∑c t√™n s·∫£n ph·∫©m" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="filterHasOrders" class="small">Tr·∫°ng th√°i:</label>
                                    <select class="form-control form-control-sm" id="filterHasOrders">
                                        <option value="all">T·∫•t c·∫£</option>
                                        <option value="has">C√≥ ƒë∆°n</option>
                                        <option value="no">Kh√¥ng c√≥ ƒë∆°n</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="minOrders" class="small">S·ªë ƒë∆°n t·ªëi thi·ªÉu:</label>
                                    <input type="number" class="form-control form-control-sm" id="minOrders" min="0" value="" placeholder="0" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="minGMV" class="small">GMV t·ªëi thi·ªÉu (‚Ç´):</label>
                                    <input type="number" class="form-control form-control-sm" id="minGMV" min="0" value="" placeholder="0" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="small">Ch·ªçn nhanh:</label>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <button type="button" class="btn btn-outline-primary quick-date-btn" data-days="7">7 ng√†y</button>
                                        <button type="button" class="btn btn-outline-primary quick-date-btn" data-days="30">30 ng√†y</button>
                                        <button type="button" class="btn btn-outline-primary quick-date-btn" data-days="90">90 ng√†y</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="start_date" class="small">T·ª´ ng√†y:</label>
                                    <input type="date" class="form-control form-control-sm" id="start_date" name="start_date" />
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label for="end_date" class="small">ƒê·∫øn ng√†y:</label>
                                    <input type="date" class="form-control form-control-sm" id="end_date" name="end_date" />
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-md-12">
                                <button type="button" class="btn btn-warning btn-sm px-3 py-1" id="applyFiltersBtn">üëâ L·ªçc d·ªØ li·ªáu</button>
                                <button type="button" class="btn btn-secondary btn-sm px-3 py-1 ml-2" id="resetFiltersBtn">üîÑ Reset</button>
                                <button type="button" class="btn btn-success btn-sm px-3 py-1 ml-2" id="exportBtn">üì• Xu·∫•t CSV</button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Summary Stats -->
                <div class="summary-stats-card">
                    <h6 class="mb-3">üìä T·ªïng quan th·ªëng k√™</h6>
                    <div class="row">
                        <div class="col-md-3 col-sm-6 mb-2">
                            <div class="summary-box total-videos">
                                <small>T·ªïng s·ªë video</small>
                                <p class="summary-value mb-0" id="summaryTotalVideos">0</p>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-2">
                            <div class="summary-box total-orders">
                                <small>T·ªïng ƒë∆°n h√†ng</small>
                                <p class="summary-value mb-0" id="summaryTotalOrders">0</p>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-2">
                            <div class="summary-box total-gmv">
                                <small>T·ªïng GMV</small>
                                <p class="summary-value mb-0" id="summaryTotalGMV">0 ‚Ç´</p>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-2">
                            <div class="summary-box total-commission">
                                <small>T·ªïng hoa h·ªìng</small>
                                <p class="summary-value mb-0" id="summaryTotalCommission">0 ‚Ç´</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="stats-card" id="chartsSection" style="display: none">
                    <h6 class="mb-3">üìà Bi·ªÉu ƒë·ªì th·ªëng k√™</h6>
                    <div class="row">
                        <div class="col-md-4">
                            <h6 class="mb-2">üèÜ Top 5 Video theo s·ªë ƒë∆°n</h6>
                            <div class="chart-container">
                                <canvas id="topOrdersChart"></canvas>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <h6 class="mb-2">üèÜ Top 5 Video theo GMV</h6>
                            <div class="chart-container">
                                <canvas id="topGMVChart"></canvas>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <h6 class="mb-2">üèÜ Top 5 Video theo hoa h·ªìng</h6>
                            <div class="chart-container">
                                <canvas id="topCommissionChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Video Table -->
                <div class="stats-card">
                    <h6 class="mb-3">üìã Danh s√°ch Video</h6>
                    <div class="table-responsive">
                        <table id="videoTable" class="table table-bordered table-hover" style="width: 100%">
                            <thead class="thead-light" style="font-size: 12px; white-space: nowrap">
                                <tr>
                                    <th>·∫¢nh</th>
                                    <th>ID S·∫£n ph·∫©m</th>
                                    <th>T√™n s·∫£n ph·∫©m</th>
                                    <th>S·ªë ƒë∆°n</th>
                                    <th>T·ªïng GMV</th>
                                    <th>T·ªïng hoa h·ªìng</th>
                                    <th>ƒê∆°n ƒë·∫ßu ti√™n</th>
                                    <th>ƒê∆°n cu·ªëi</th>
                                    <th style="width: 50px">Chi ti·∫øt</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng -->
            <div class="guide-section">
                <h5>üìñ Gi·ªõi thi·ªáu & H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h5>

                <div class="feature-item">
                    <strong>üìπ Trang T·ªïng quan Video l√† g√¨?</strong>
                    <p class="mb-0 mt-2">
                        Trang n√†y gi√∫p b·∫°n theo d√µi v√† ph√¢n t√≠ch hi·ªáu qu·∫£ c·ªßa c√°c video s·∫£n ph·∫©m tr√™n Shopee. B·∫°n c√≥ th·ªÉ xem th·ªëng k√™ v·ªÅ s·ªë ƒë∆°n h√†ng, GMV (Gross Merchandise Value) v√† hoa h·ªìng ƒë∆∞·ª£c t·∫°o
                        ra t·ª´ m·ªói video s·∫£n ph·∫©m.
                    </p>
                </div>

                <h6>üéØ C√°c t√≠nh nƒÉng ch√≠nh:</h6>
                <ul>
                    <li><strong>T·ªïng quan th·ªëng k√™:</strong> Hi·ªÉn th·ªã t·ªïng s·ªë video, t·ªïng ƒë∆°n h√†ng, t·ªïng GMV v√† t·ªïng hoa h·ªìng trong kho·∫£ng th·ªùi gian ƒë√£ ch·ªçn.</li>
                    <li><strong>Bi·ªÉu ƒë·ªì th·ªëng k√™:</strong> Hi·ªÉn th·ªã Top 5 video theo s·ªë ƒë∆°n, GMV v√† hoa h·ªìng ƒë·ªÉ d·ªÖ d√†ng so s√°nh hi·ªáu qu·∫£.</li>
                    <li><strong>Danh s√°ch video:</strong> B·∫£ng chi ti·∫øt t·∫•t c·∫£ c√°c video v·ªõi ƒë·∫ßy ƒë·ªß th√¥ng tin v·ªÅ ƒë∆°n h√†ng, GMV v√† hoa h·ªìng.</li>
                    <li><strong>Xem chi ti·∫øt:</strong> Click v√†o n√∫t "Chi ti·∫øt" ƒë·ªÉ xem danh s√°ch ƒë∆°n h√†ng t·ª´ video c·ª• th·ªÉ.</li>
                </ul>

                <h6>üîç H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng b·ªô l·ªçc:</h6>
                <ul>
                    <li><strong>T√¨m ki·∫øm:</strong> Nh·∫≠p ID s·∫£n ph·∫©m ho·∫∑c t√™n s·∫£n ph·∫©m ƒë·ªÉ t√¨m video c·ª• th·ªÉ.</li>
                    <li>
                        <strong>Tr·∫°ng th√°i:</strong>
                        <ul>
                            <li><strong>T·∫•t c·∫£:</strong> Hi·ªÉn th·ªã t·∫•t c·∫£ video (c√≥ ƒë∆°n v√† kh√¥ng c√≥ ƒë∆°n)</li>
                            <li><strong>C√≥ ƒë∆°n:</strong> Ch·ªâ hi·ªÉn th·ªã video ƒë√£ c√≥ ƒë∆°n h√†ng</li>
                            <li><strong>Kh√¥ng c√≥ ƒë∆°n:</strong> Ch·ªâ hi·ªÉn th·ªã video ch∆∞a c√≥ ƒë∆°n h√†ng</li>
                        </ul>
                    </li>
                    <li><strong>S·ªë ƒë∆°n t·ªëi thi·ªÉu:</strong> L·ªçc video c√≥ s·ªë ƒë∆°n h√†ng l·ªõn h∆°n ho·∫∑c b·∫±ng s·ªë b·∫°n nh·∫≠p.</li>
                    <li><strong>GMV t·ªëi thi·ªÉu:</strong> L·ªçc video c√≥ t·ªïng GMV l·ªõn h∆°n ho·∫∑c b·∫±ng s·ªë ti·ªÅn b·∫°n nh·∫≠p (ƒë∆°n v·ªã: VNƒê).</li>
                    <li><strong>Ch·ªçn nhanh:</strong> Click v√†o c√°c n√∫t "7 ng√†y", "30 ng√†y", "90 ng√†y" ƒë·ªÉ t·ª± ƒë·ªông ch·ªçn kho·∫£ng th·ªùi gian t∆∞∆°ng ·ª©ng t√≠nh t·ª´ h√¥m nay.</li>
                    <li><strong>T·ª´ ng√†y / ƒê·∫øn ng√†y:</strong> Ch·ªçn kho·∫£ng th·ªùi gian c·ª• th·ªÉ ƒë·ªÉ xem d·ªØ li·ªáu.</li>
                </ul>

                <h6>üìä Gi·∫£i th√≠ch c√°c th·ªëng k√™:</h6>
                <ul>
                    <li><strong>T·ªïng s·ªë video:</strong> S·ªë l∆∞·ª£ng video s·∫£n ph·∫©m trong kho·∫£ng th·ªùi gian ƒë√£ ch·ªçn.</li>
                    <li><strong>T·ªïng ƒë∆°n h√†ng:</strong> T·ªïng s·ªë ƒë∆°n h√†ng ƒë∆∞·ª£c t·∫°o ra t·ª´ t·∫•t c·∫£ c√°c video.</li>
                    <li><strong>T·ªïng GMV:</strong> T·ªïng gi√° tr·ªã ƒë∆°n h√†ng (Gross Merchandise Value) t·ª´ c√°c video.</li>
                    <li><strong>T·ªïng hoa h·ªìng:</strong> T·ªïng s·ªë ti·ªÅn hoa h·ªìng b·∫°n nh·∫≠n ƒë∆∞·ª£c t·ª´ c√°c ƒë∆°n h√†ng video.</li>
                </ul>

                <h6>üí° M·∫πo s·ª≠ d·ª•ng:</h6>
                <ul>
                    <li>S·ª≠ d·ª•ng b·ªô l·ªçc ƒë·ªÉ t√¨m video hi·ªáu qu·∫£ nh·∫•t ho·∫∑c video ch∆∞a c√≥ ƒë∆°n h√†ng ƒë·ªÉ t·ªëi ∆∞u h√≥a.</li>
                    <li>Xem bi·ªÉu ƒë·ªì Top 5 ƒë·ªÉ nhanh ch√≥ng x√°c ƒë·ªãnh video n√†o ƒëang ho·∫°t ƒë·ªông t·ªët nh·∫•t.</li>
                    <li>Click "Chi ti·∫øt" ƒë·ªÉ xem danh s√°ch ƒë∆°n h√†ng t·ª´ video c·ª• th·ªÉ v√† ph√¢n t√≠ch s√¢u h∆°n.</li>
                    <li>S·ª≠ d·ª•ng n√∫t "Xu·∫•t CSV" ƒë·ªÉ t·∫£i d·ªØ li·ªáu v·ªÅ m√°y v√† ph√¢n t√≠ch b·∫±ng Excel ho·∫∑c Google Sheets.</li>
                    <li>K·∫øt h·ª£p v·ªõi trang "L·ªãch s·ª≠ ƒë∆°n h√†ng" ƒë·ªÉ xem th√¥ng tin chi ti·∫øt h∆°n v·ªÅ t·ª´ng ƒë∆°n h√†ng.</li>
                </ul>

                <div class="alert alert-info mt-3 mb-0 p-0">
                    <strong>üí¨ L∆∞u √Ω:</strong> D·ªØ li·ªáu ƒë∆∞·ª£c l·∫•y t·ª´ c√°c ƒë∆°n h√†ng ƒë√£ ƒë∆∞·ª£c l∆∞u trong h·ªá th·ªëng. N·∫øu b·∫°n ch∆∞a th·∫•y d·ªØ li·ªáu, h√£y ƒë·∫£m b·∫£o b·∫°n ƒë√£ thu th·∫≠p ƒë∆°n h√†ng t·ª´ Shopee tr∆∞·ªõc ƒë√≥.
                </div>
            </div>
        </div>

        <!-- Detail Modal -->
        <div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header p-2">
                        <h6 class="modal-title" id="detailModalTitle">Chi ti·∫øt Video</h6>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body p-2">
                        <div id="videoDetailInfo" class="mb-3"></div>
                        <div>
                            <h6>ƒê∆°n h√†ng t·ª´ video n√†y (T·ªïng: <span id="detailOrdersCount">0</span>)</h6>
                            <div class="table-responsive" style="max-height: 400px">
                                <table class="table table-sm table-bordered table-hover">
                                    <thead class="table-light">
                                        <tr>
                                            <th>#</th>
                                            <th>Order ID</th>
                                            <th>Ng√†y ƒë∆°n</th>
                                            <th class="text-end">GMV</th>
                                            <th class="text-end">Hoa h·ªìng</th>
                                            <th>Tr·∫°ng th√°i</th>
                                        </tr>
                                    </thead>
                                    <tbody id="detailOrdersList">
                                        <!-- Populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer p-2">
                        <a href="#" id="viewOrderHistoryLink" class="btn btn-primary" target="_blank">Xem trong l·ªãch s·ª≠ ƒë∆°n h√†ng</a>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒê√≥ng</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scripts -->
        <script src="/js/jquery.min.js"></script>
        <script src="/js/bootstrap.bundle.min.js"></script>
        <script src="/js/chart.js"></script>
        <script src="/js/chartjs-plugin-datalabels.min.js"></script>
        <script src="/js/jquery.dataTables.min.js"></script>
        <script src="/js/dataTables.bootstrap5.min.js"></script>
        <script src="/js/idb.js"></script>
        <script src="/js/common-header.js"></script>
        <script src="/js/processOrderData.js"></script>
        <script src="/js/video-overview.js"></script>
    </body>
</html>
